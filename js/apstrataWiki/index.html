<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ap((strata wiki</title>
    <style type="text/css">
        @import "../dojo/1.2.3/dijit/themes/tundra/tundra.css";
        @import "../dojo/1.2.3/dojo/resources/dojo.css"
    </style>
    <script type="text/javascript" src="../dojo/1.2.3/dojo/dojo.xd.js" djConfig="parseOnLoad: true"></script>
    <script type="text/javascript">
        dojo.require("dojo.parser");
        dojo.require("dijit.layout.ContentPane");
        dojo.require("dijit.layout.LayoutContainer");
        dojo.require("dijit.layout.SplitContainer");

        dojo.require("dojo.data.ItemFileWriteStore");
        dojo.require("dijit.Tree");
        dojo.require("dijit._tree.dndSource");

        dojo.require("dijit.Menu");
        dojo.require("dojo.parser");  // scan page for widgets and instantiate them
        dojo.require("dijit.Editor");

        dojo.require("dijit.InlineEditBox");

	dojo.registerModulePath ("apstrata.wiki", "../../../apstrataWiki");
	dojo.require("apstrata.wiki.widgets.WikiEditor");
	dojo.require("apstrata.wiki.widgets.PageTree");

	dojo.registerModulePath ("apstrata", "../../../apstrata");
	dojo.require("apstrata.dojo.client.apsdb.ListStores");
        dojo.require("apstrata.dojo.tests.Credentials");

        var i = 0;
        var pageCounter=0;
        
        dojo.addOnLoad(function() {
            dojo.connect(pagesTree, "selectPage", function() {
                /*
                var editor = new apstrata.wiki.widgets.WikiEditor({
                                    title: pagesTree.selectedObject.title ,
                                    contents: pagesTree.selectedObject.contents,
                                    tags: "",
                                    breadCrumbs: "page1 / page2 / page3"
                                });
                */

                var editor = new apstrata.wiki.widgets.WikiEditor(pagesTree.selectedObject);

                dojo.byId("wikiEditorPane").innerHTML = ""; // how to do it dojo way?
                
                dojo.place(editor.domNode, "wikiEditorPane", "first");
            })
        });

    </script>

    <style> 
        /* NOTE: for a full screen layout, must set body size equal to the viewport. */
        html, body { height: 100%; width: 100%; margin: 0; padding: 0; font-family: sans-serif;}
      
        #header {padding: 8px; background-color:#DDDDDD; font-size: 1em;}
        #footer {padding: 10px; background-color:#DDDDDD; text-align: right; font-size: .8em;}
        #tree {background-color: #FFFFFF; padding: 5px;font-size:1.1em; color: #222222;}
        .title {font-weight: bold; font-size: 1.2em;}
        .breadCrumbs {font-size: 0.8em;}
        
    </style>


</head>
<body class="tundra">
    <div dojoType="dojo.data.ItemFileWriteStore" jsId="pageStore" url="wikidata4.json"></div>
    
    <div dojoType="dijit.layout.LayoutContainer" style="width: 100%; height: 100%; padding: 0; margin: 0; border: 0;">
        <div dojoType="dijit.layout.ContentPane" layoutAlign="top" id="header">
            <table style="width: 100%;">
                <tr>
                    <td><img src="images/apstrata-sml.png" /></td>
                    <td align="right"><h3>wiki</h3></td>
                </tr>
            </table>
        </div>
        <div dojoType="dijit.layout.ContentPane" layoutAlign="client">
            <div dojoType="dijit.layout.SplitContainer" orientation="horizontal" sizerWidth="7" activeSizing="true">
                <div dojoType="dijit.layout.ContentPane" style="border: 0px; margin: 0px;">
                    <div dojoType="apstrata.wiki.widgets.PageTree" jsId="pagesTree" abc="abc"></div>
                </div>
                <div dojoType="dijit.layout.ContentPane" sizeMin="50" sizeShare="50">
                    <div id="wikiEditorPane"></div>
                </div>
            </div>
        </div>        
        <div dojoType="dijit.layout.ContentPane" layoutAlign="bottom" id="footer">
            (c) 2009 apstrata
        </div>
    </div>

</body>
</html>