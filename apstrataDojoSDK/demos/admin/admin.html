<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ap((strata database admin console</title>
    <style type="text/css">
        @import "../../lib/dojo/1.3.0-src/dijit/themes/tundra/tundra.css";
        @import "../../lib/dojo/1.3.0-src/dojo/resources/dojo.css";
        @import "../../apstrata/resources/css/apstrata.css";
    </style>
	
    <style type="text/css"> 
        /* NOTE: for a full screen layout, must set body size equal to the viewport. */
        html, body { height: 100%; width: 100%; margin: 0; padding: 0; font-family: sans-serif;}
      
        #header {padding: 8px; font-size: 1em;}
        #footer {padding: 10px; text-align: right; font-size: .8em;}
 
 
 		#list {
			position:absolute; left:0px; cursor:pointer;
		}
		#container { margin:0 auto; width:400px; }
		#list ul {
			width:175px;
			list-style-type:none;
		}
		.ilk {
			border-top:1px solid #999;
			color:#666;
			font:0.8em Arial,sans-serif;
		}
		.fisheyeTarget {
			font:1em Arial, sans-serif;
			color: #000077;
		}

    </style>
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="images/favicon.png" type="image/png" />
    
	<script type="text/javascript" src="../../lib/dojo/1.3.0-src/dojo/dojo.js" djConfig="parseOnLoad: true, isDebug:true"></script>
	<script type="text/javascript" src="../../apstrata/apstrata.js"></script>

    <script type="text/javascript">
        dojo.require("dojo.parser");
        dojo.require("dijit.layout.ContentPane");
        dojo.require("dijit.layout.LayoutContainer");
        dojo.require("dijit.layout.SplitContainer");
        
        dojo.require("dijit.Tree");
        dojo.require("dijit._tree.dndSource");

        var connection;
        var connectionStatus;
        var connectionError;
		
		function navigateToTag(tag) {
			if ((tag != undefined) && (tag != "")) {
				console.debug("click " + tag)
//						dijit.byId("page").attr("href", tag.title+".html")
				dojo.byId("page").src = tag+".html"
			}
		}
        
        dojo.addOnLoad(function() {
			dojo.require ("apstrata.util.logger.Logger");
			dojo.require ("apstrata.apsdb.client.Connection");
	        dojo.require ("apstrata.apsdb.client.widgets.Login");
			dojo.require ("apstrata.apsdb.client.widgets.LoginArea")
			
	        dojo.require("apstrata.apsdb.client.widgets.ConnectionStatus");
	
			dojo.require("dojox.widget.FisheyeLite");
					
			dojo.query("li.bounce").instantiate(dojox.widget.FisheyeLite,{properties: {fontSize: 1.5}})
			
			dojo.byId("page").src = "ListStores.html"
			
			dojo.query("li.bounce").forEach(function(tag) {
				dojo.connect(tag, "onclick", function() {
					navigateToTag(tag.id)
				})
				
//				console.dir(tag)
			})
	
            // A connection object sets the basic params needed to communicate with apstrata
            //  The connection object represents a pseudo session
		    connection = new apstrata.apsdb.client.Connection()
			
			var loginArea = new apstrata.apsdb.client.widgets.LoginArea({connection: connection})
			
			dojo.connect(loginArea, "onChange", function(status) {
				if (status) {
					navigateToTag("ListStores")
				} else {
					navigateToTag("home")
				}
			})
			
			dojo.byId("loginArea").appendChild(loginArea.domNode);

//			connection.loadFromCookie()
			

            // the ConnectionStatus and ConnectionError widgets monitor the connection object
            //  for activity and timeout and reflect that to the user throug a dialog
//            connectionStatus = new apstrata.apsdb.client.widgets.ConnectionStatus(connection);
//            connectionError = new apstrata.dojo.widgets.ConnectionError(connection);
            if (false) {
                var login = new apstrata.apsdb.client.widgets.Login(connection)		

                dojo.connect(login, "loginSuccess", function() {
                    initApplicationPanel()
                });
                dojo.connect(login, "close", function() {
                    alert('Adieu mon ami, a bientot!')
                });
		
            } else {
				// Connection params are loaded from 'apConfig' attribute 
				//   in the apstrata.js script loading tag
                initApplicationPanel()
            }
        });

        var editor = null

        function initApplicationPanel() {
        }
    </script>
</head>
<body class="tundra">
	
    <div dojoType="dijit.layout.LayoutContainer" id="appDesktop" style="width: 100%; height: 100%; padding: 0; margin: 0; border: 0;">
        <div dojoType="dijit.layout.ContentPane" layoutAlign="top" id="header">
            <table style="width: 100%;">
                <tr>
                    <td><img src="images/apstrata-sml.png" /></td>
                    <td align="right"><h3>admin</h3></td>
				</tr>
				<tr>
                    <td></td>
                    <td align="right"><div id="loginArea"></div></td>
                </tr>
            </table>
        </div>
        <div dojoType="dijit.layout.ContentPane" layoutAlign="client">
            <div class="rounded box3 shadow" style="border: 0px; margin: 0px; width:20%; height:90%; float:left;">
				<div id="list">
					<ul>
						<li class="bounce" id="ListStores"><span class="fisheyeTarget" title="Create/Delete/List stores">Stores</span><br><div class="ilk">Create/Delete/List stores</div></li>
						<br>
						<li class="bounce" title="Query"><span class="fisheyeTarget">Run Query</span><br><div class="ilk">Run a query on a store</div></li>
						<li class="bounce"><span class="fisheyeTarget">Get/Edit Document</span><br><div class="ilk">Get an object from a store</div></li>
						<li class="bounce"><span class="fisheyeTarget">New Document</span><br><div class="ilk">Create a new Document</div></li>
						<br>
						<li class="bounce"><span class="fisheyeTarget">Users</span><br><div class="ilk">List/edit user accounts</div></li>
						<li class="bounce" id="ListGroups"><span class="fisheyeTarget" title="Create/Delete/List groups">Groups</span><br><div class="ilk">Create/Delete/List groups</div></li>
						<br>
					</ul>
				</div>
            </div>
            <div style="float:left; padding:10px; width: 70%; height: 80%;">
				<iframe src="home.html" 
					width="100%" 
					height="100%" 
					id="page"
					frameborder="0"></iframe>
				<!-- div dojoType="dijit.layout.ContentPane" id="pagef" style="width:100%; height:100%;"></div -->
            </div>
        </div>        
        <div dojoType="dijit.layout.ContentPane" layoutAlign="bottom" id="footer">
            &#169; 2009 apstrata
        </div>
    </div>
</body>
</html>