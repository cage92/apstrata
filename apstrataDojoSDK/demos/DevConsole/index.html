<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<title>ap((strata Developer Console</title>

	    <link rel="shortcut icon" href="images/favicon.png" type="image/png" />
	
		<script type="text/javascript" src="../../lib/dojo/1.3.0-src/dojo/dojo.js" djConfig="parseOnLoad: false"></script>
		<script type="text/javascript" src="../../apstrata/apstrata.js" apConfig="key:'7744293024',secret:'3B45DE19C689EDAFCA47'"></script>

		<!-- 
			icons are under cc license from http://olawolska.com/newsy/49-hand-drawing-icons-set/
		-->

	    <style type="text/css">
		    @import "../../lib/dojo/1.3.0-src/dijit/themes/nihilo/nihilo.css";
		    @import "../../lib/dojo/1.3.0-src/dojox/grid/resources/nihiloGrid.css";
	
	        @import "../../apstrata/themes/apstrata/apstrata.css";
	        @import "../../apstrata/themes/apstrata/LoginWidget.css";
	        @import "../../apstrata/themes/apstrata/Alert.css";

			@import "css/Toaster.css";
			@import "css/forms.css";
			@import "css/admin.css";

			.ConsoleOutput {
				background: #dedede;
				position: absolute;
				opacity: .95;
				visibility: hidden;
				z-index: 4000;
				border: solid 1px #cecece;
			}
			
			.ConsoleOutput .output {
				width: 1000px;
				height: 400px;
				color: white;
				padding: 10px;

				overflow-y: auto;
				overflow-x: hidden;
			}
			
			.ConsoleOutput .title {
				text-align: center; 
				color: #222222;
				background: #dedede;
				font-family: sans-serif;
				font-size: 0.8em;
				padding: 3px;
				font-weight: bold;
			}
			
			.ConsoleOutput .request {
				
			}
			
			.response {
				background: '#99ff66'; 
				color: '#222222';
				fontFamily: 'monospace'; 
				padding: '4px';
				marginBottom: '4px';
			}
			
			.ConsoleOutput .failure {
				
			}

	    </style>
		
		<script>
			dojo.require("dijit._Widget")
			dojo.require("dojox.dtl._Templated")
			dojo.require("dijit.layout._LayoutWidget")
			dojo.require("dojox.dtl._Templated")
			dojo.require("dojo.fx.easing");
			dojo.require("dijit.form.Button")
			
			dojo.require("dojox.widget.Toaster")

			dojo.require("apstrata.widgets.Alert")
			dojo.require("apstrata.widgets.SlidingPanel")
			dojo.require("apstrata.widgets.client.ConnectionStatus")
			
//			dojo.require("apstrata.apsdb.client.widgets.LoginWidget")
			dojo.require("apstrata.widgets.client.LoginWidget")

			var connection 
			
			dojo.require('apstrata.widgets.HStackableContainer')
			dojo.require("apstrata.Client")
			dojo.require("apstrata.StickyConnection")
			
			dojo.addOnLoad(function() {

				connection = new apstrata.StickyConnection()

/*
				connection = new apstrata.StickyConnection({
					credentials: {
						key: "7744293024",
						secret: "3B45DE19C689EDAFCA47" + "x"
					}
				})
*/				

//			connection.serviceUrl = "http://apsdb.apstrata.com/sandbox-apsdb/rest"
//			connection.timeout = 1000
				
				
				dojo.registerModuleRelative ("apstrata.admin", "apstrata/admin");
				dojo.require('apstrata.admin.DevConsole')
				dojo.require('apstrata.admin.RESTMonitor')
				toast = dijit.byId("toast")
				dojo.parser.parse()
								
				dojo.subscribe("/apstrata/operation", function(data) {
					var style
					if (data.response) {
						if (data.success == 'success') {
							style = {position: 'relative', left: '30px', width: '950px', background: '#99ff66', color: '#222222', fontFamily: 'monospace', padding: '10px', marginBottom: '10px'}
						} else {
							style = {position: 'relative', left: '30px', width: '950px', background: '#ff9966', color: '#222222', fontFamily: 'monospace', padding: '10px', marginBottom: '10px'}
						}
					} else {
						style = {width: '950px', background: '#a1a1a1', color: '#222222', fontFamily: 'monospace', padding: '10px', marginBottom: '1px'}
					}
					
					var c = dojo.byId("dvMonitorOutput")
					
					var n = dojo.create(
						"div", 
						{innerHTML: data.message, style: style}, 
						c
					)
		
//					dojo.connect(loginWidget, "loginSuccess", function() {
//						adminWidget.home()
//					})
	
					dojo.addClass(n, 'rounded-sml')
					c.scrollTop = c.scrollHeight - c.clientHeight
		
				})
			})
		</script>
	</head>
	<body class='nihilo'>
		<!-- div class="logo">ap<span style="color: #FF6600;">((</span>strata</div-->
		<img src="../../apstrata/resources/images/apstrata-big.png" style='position: absolute; width: 250px; left: 50px; top: 25px;'>
		<div class='appTitle'>Developer Console</div>		

		<div dojoType='apstrata.widgets.SlidingPanel' 
			dojoAttachPoint='slidingPanel' 
			class='ConsoleOutput rounded-top-sml' 
			attach='bottom' 
			visibleWidth='20'>
			<div class='title rounded-top-sml'>REST Monitor</div>
			<div class='output' id='dvMonitorOutput' class='rounded'>
				<div style='font-family: sans-serif; font-size: 1.4em; padding: 30px; color: #888888; height: 100px;margin-bottom: 10px;' class='rounded-sml'>
					This panel will display the REST HTTP conversation between the console and apstrata</div>
				</div>
			<br>
		</div>

		<div dojoType='apstrata.widgets.client.ConnectionStatus'></div>

		<div dojoType="dojox.widget.Toaster" id="toast" 
			positionDirection="tr-left" duration="0" 
			messageTopic="/apstrata/connection"></div>    

<!--
	 	<div dojoType="apstrata.widgets.client.LoginWidget"  jsId="loginWidget"
			connection='connection' 
			visibleWidth="17" 
			offsetFromCenter="440"></div>
-->
		<div dojoType="apstrata.admin.DevConsole" jsId='adminWidget'
			connection='connection'></div>
	</body>
</html>
