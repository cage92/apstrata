<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<title>ap((strata Code Explorer</title>

	    <link rel="shortcut icon" href="images/favicon.png" type="image/png" />
	
		<script type="text/javascript" src="../../lib/dojo/1.3.0-src/dojo/dojo.js" djConfig="parseOnLoad: false"></script>
		<script type="text/javascript" src="../../apstrata/apstrata.js" apConfig="key:'7744293024',secret:'3B45DE19C689EDAFCA47'"></script>

		<!-- 
			icons are under cc license from http://olawolska.com/newsy/49-hand-drawing-icons-set/
		-->

	    <style type="text/css">
		    @import "../../lib/dojo/1.3.0-src/dijit/themes/nihilo/nihilo.css";
		    @import "../../lib/dojo/1.3.0-src/dojox/grid/resources/nihiloGrid.css";
			@import "../../lib/dojo/1.3.0-src/dojox/form/resources/FileInput.css";
	
	        @import "../../apstrata/themes/apstrata/apstrata.css";
	        @import "../../apstrata/themes/apstrata/Alert.css";
	        @import "../../apstrata/themes/apstrata/HStackableContainer.css";
	        @import "../../apstrata/themes/apstrata/RESTMonitor.css";

			@import "css/blog.css";
			@import "css/Toaster.css";
			@import "css/forms.css";
			@import "css/explorer.css";

			.title {
				font-family: sans-serif;
				text-align: center;
			}

	    </style>
		
		<script>
			
			dojo.require("dojox.widget.Toaster")
			dojo.require("apstrata.widgets.client.ConnectionStatus")
			dojo.require('apstrata.widgets.client.RESTMonitor')
			
			var connection 

			dojo.require("apstrata.Client")
			dojo.require("apstrata.StickyConnection")
			dojo.require("apstrata.util.BulkUpdate")
			

			dojo.addOnLoad(function() {


/*
				connection = new apstrata.StickyConnection()
*/				

				connection = new apstrata.StickyConnection({
					credentials: {
						key: "7744293024",
//						un: "jobblog",
//						pw: "12345"
						secret: "3B45DE19C689EDAFCA47"
					}
				})

				connection.timeout = 60000
/*
				connection.serviceUrl = "http://apsdb.apstrata.com/sandbox-apsdb/rest"
*/				

				dojo.registerModuleRelative ("apstrata.explorer", "apstrata/explorer");
				
				toast = dijit.byId("toast")
				dojo.parser.parse()


				var data = {
					stores: [
						{
							apsdb: {
								store: 'explorerBlog',
								saveDocumentACL: 'group:blog-users',
								deleteDocumentACL: 'group:blog-users',
								getFileACL: 'group:blog-users',
								queryACL: 'group:blog-users'
							}
						}
					],
					
					groups: [
						{
							apsim: {
								group: 'blog-users'
							}	
						},
						{
							apsim: {
								group: 'blog-admins'
							}	
						}
					],
					
					users: [
						{
							apsim:{
								user: 'joe',
								password: 'qw3rty',
								name: 'Joe Blogger',
								email: 'joe.blogger.explorer@apstrata.com',
								group: 'blog-users',
								update: 'false'
							}
						},
						{
							apsim:{
								user: 'jane',
								password: 'qw3rty',
								name: 'Jane Blogger',
								email: 'jane.blogger.explorer@apstrata.com',
								group: 'blog-users',
								update: 'false'
							}
						},
					]
				}

				
				var is = new apstrata.util.BulkUpdate({connection: connection, data: data})
				
			})
		</script>
	</head>
	<body class='nihilo'>
		<img src="../../apstrata/resources/images/apstrata-big.png" class='logo'>
		<div class='appTitle'>Code Explorer</div>		
		<div style='clear:both'></div>

		<div class='rounded-top-sml' style='padding: 10px; background: #ededed;width: 1050px; height: 80%; overflow-x: none; overflow-y: auto; margin-left: auto; margin-right: auto;'>
			<div dojoType='apstrata.widgets.client.RESTMonitor'></div>
		</div>

		<div dojoType='apstrata.widgets.client.ConnectionStatus'></div>

		<div dojoType="dojox.widget.Toaster" id="toast" 
			positionDirection="br-left" duration="0" 
			messageTopic="/apstrata/connection"></div>    
	</body>
</html>
