<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ap((strata wiki</title>
    <style type="text/css">
        @import "../../lib/dojo/1.3.0-src/dijit/themes/tundra/tundra.css";
        @import "../../lib/dojo/1.3.0-src/dojo/resources/dojo.css"
		@import "../../apstrata/resources/css/apstrata.css";
    </style>
	
    <style type="text/css"> 
        /* NOTE: for a full screen layout, must set body size equal to the viewport. */
        html, body { height: 100%; width: 100%; margin: 0; padding: 0; font-family: sans-serif;}
      
        .header {padding: 8px; background-color:#DDDDDD; font-size: 1em;}
        .footer {padding: 10px; background-color:#DDDDDD; text-align: right; font-size: .8em;}
        .title {font-weight: bold; font-size: 1.2em;}
        .breadCrumbs {font-size: 0.8em;}        
    </style>
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="images/favicon.png" type="image/png" />
    
	<script type="text/javascript" src="../../lib/dojo/1.3.0-src/dojo/dojo.js" djConfig="parseOnLoad: true, isDebug:true"></script>
	<script type="text/javascript" src="../../apstrata/apstrata.js" apConfig="key:'7744293024', secret:'3B45DE19C689EDAFCA47', defaultStore:'wiki', timeout: 10000"></script>

    <script type="text/javascript">
        dojo.require("dojo.parser");
        dojo.require("dijit.layout.ContentPane");
        dojo.require("dijit.layout.LayoutContainer");

        var connection;
        var connectionStatus;
        var connectionError;
        
        dojo.addOnLoad(function() {
			dojo.require ("apstrata.util.logger.Logger");
			dojo.require ("apstrata.apsdb.client.Connection");
			
	        dojo.require("apstrata.apsdb.client.widgets.ConnectionStatus");
	        dojo.require("apstrata.apsdb.client.widgets.Login");
	
			dojo.registerModuleRelative ("apstrata.wiki", "apstrata/wiki");
			dojo.require("apstrata.wiki.widgets.Blog");
			dojo.require("apstrata.wiki.widgets.BlogEntry");

            // A connection object sets the basic params needed to communicate with apstrata
            //  The connection object represents a pseudo session
		    connection = new apstrata.apsdb.client.Connection()

            // the ConnectionStatus and ConnectionError widgets monitor the connection object
            //  for activity and timeout and reflect that to the user throug a dialog
            connectionStatus = new apstrata.apsdb.client.widgets.ConnectionStatus(connection);
//            connectionError = new apstrata.dojo.widgets.ConnectionError(connection);

            if (false) {
                var login = new apstrata.apsdb.client.widgets.Login(connection)		

                dojo.connect(login, "loginSuccess", function() {
                    initApplicationPanel()
                });
                dojo.connect(login, "close", function() {
                    alert('Adieu mon ami, a bientot!')
                });
		
            } else {
				// Connection params are loaded from 'apConfig' attribute 
				//   in the apstrata.js script loading tag
                initApplicationPanel()
            }
        });

        function initApplicationPanel() {
			var blog = new apstrata.wiki.widgets.Blog(connection, "entries")
        }
    </script>
</head>
<body class="tundra">
    <div dojoType="dijit.layout.LayoutContainer" id="appDesktop" style="width: 100%; height: 100%; padding: 0; margin: 0; border: 0;">
        <div dojoType="dijit.layout.ContentPane" layoutAlign="top">
        	<div class="rounded-top header">
	            <table style="width: 100%;">
	                <tr>
	                    <td><img src="images/apstrata-sml.png" /></td>
	                    <td align="right"><h3>wiki</h3></td>
	                </tr>
	            </table>
        	</div>
        </div>
        <div dojoType="dijit.layout.ContentPane" layoutAlign="client">
        	<div id="entries"></div>
        </div>        
        <div dojoType="dijit.layout.ContentPane" layoutAlign="bottom" class="footer">
            (c) 2009 apstrata
        </div>
    </div>
</body>
</html>